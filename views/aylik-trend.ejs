<%- include('partials/header') %>
<%- include('partials/sidebar') %>

<style>
    .chart-container {
        background-color: #fff;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
</style>

<main class="main-content">
    <h1><%= sayfaBasligi %></h1>

    <div class="chart-container">
        <canvas id="trendChart"></canvas>
    </div>
</main>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const ctx = document.getElementById('trendChart').getContext('2d');
        const trendData = <%- JSON.stringify(sonuclar) %>;

        const ayIsimleri = ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"];
        
        const labels = trendData.map(d => `${d.YIL}-${ayIsimleri[d.AY - 1]}`);
        const ciroData = trendData.map(d => d.ToplamCiro);
        const karData = trendData.map(d => d.ToplamKar);

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Toplam Ciro',
                        data: ciroData,
                        borderColor: 'rgba(52, 152, 219, 1)',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true,
                        tension: 0.1
                    },
                    {
                        label: 'Toplam Kâr',
                        data: karData,
                        borderColor: 'rgba(39, 174, 96, 1)',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        fill: true,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                    tooltip: { mode: 'index', intersect: false }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
    });
</script>

<%- include('partials/footer') %>
