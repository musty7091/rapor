<%- include('partials/header') %>
<%- include('partials/sidebar') %>

<main class="main-content">

    <h1><i class="fa-solid fa-sack-dollar"></i> <%= sayfaBasligi %></h1>

    <%# YENİ BİLGİLENDİRME METNİ %>
    <div class="info-box" style="background: #fff; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border-left: 5px solid var(--primary-color);">
        <p style="font-size: 1.1rem; color: #555;">
            Bu rapor, <strong>2025</strong> yılına ait <strong>ALİ ERTAN CO LTD</strong> tedarikçisinin ürün karlılığını göstermektedir.
        </p>
    </div>

    <% if (sonuclar && sonuclar.length > 0) { %>
        <div class="kpi-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
            <div class="kpi-card">
                <div class="icon"><i class="fa-solid fa-coins"></i></div>
                <div class="info">
                    <h3>Toplam Ciro</h3>
                    <div class="value"><%= kpis.toplamCiro.toLocaleString('tr-TR', { style: 'currency', currency: 'TRY' }) %></div>
                </div>
            </div>
            <div class="kpi-card">
                <div class="icon"><i class="fa-solid fa-piggy-bank"></i></div>
                <div class="info">
                    <h3>Toplam Brüt Kâr</h3>
                    <div class="value"><%= kpis.toplamKar.toLocaleString('tr-TR', { style: 'currency', currency: 'TRY' }) %></div>
                </div>
            </div>
            <div class="kpi-card">
                <div class="icon"><i class="fa-solid fa-percent"></i></div>
                <div class="info">
                    <h3>Ortalama Kârlılık</h3>
                    <div class="value <%= kpis.ortalamaKarlilik >= 0 ? 'karlilik-pozitif' : 'karlilik-negatif' %>"><%= kpis.ortalamaKarlilik.toFixed(2) %>%</div>
                </div>
            </div>
            <div class="kpi-card">
                <div class="icon"><i class="fa-solid fa-box-open"></i></div>
                <div class="info">
                    <h3>Listelenen Ürün</h3>
                    <div class="value"><%= kpis.urunSayisi %></div>
                </div>
            </div>
        </div>
    <% } %>

    <table>
        <thead>
            <tr>
                <th>Ürün Adı</th>
                <th>Toplam Ciro</th>
                <th>Toplam Kâr</th>
                <th>Kârlılık Oranı</th>
            </tr>
        </thead>
        <tbody>
            
            <% if (sonuclar && sonuclar.length > 0) { %>
                <% sonuclar.forEach(s => { %>
                    <tr>
                        <td><%= s.STOK_ADI %></td>
                        <td class="sayisal"><%= s.ToplamCiro.toLocaleString('tr-TR', { style: 'currency', currency: 'TRY' }) %></td>
                        <td class="sayisal"><%= s.ToplamKar.toLocaleString('tr-TR', { style: 'currency', currency: 'TRY' }) %></td>
                        <% const karlilik = s.ToplamCiro > 0 ? (s.ToplamKar / s.ToplamCiro) * 100 : 0; %>
                        <td class="sayisal <%= karlilik >= 0 ? 'karlilik-pozitif' : 'karlilik-negatif' %>"><%= karlilik.toFixed(2) %>%</td>
                    </tr>
                <% }) %>
            <% } else { %>
                <tr>
                    <td colspan="4" style="text-align: center; padding: 20px;">Belirtilen kriterlere (Yıl: 2025, Tedarikçi: ALİ ERTAN CO LTD) uygun veri bulunamadı.</td>
                </tr>
            <% } %>
        </tbody>
    </table>
</main>

<%- include('partials/footer') %>